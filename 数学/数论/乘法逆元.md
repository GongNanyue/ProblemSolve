##### 逆元存在定理

如果$x x^{-1} \equiv 1 \mod p$

接下来将给出 $\gcd(x, p) = 1 $时的逆元构造算法。

于是只需证明$\gcd(x, p) = d \ne 1 $时逆元不存在。

 反证，假设存在$ x ^{-1}$，使$ x\times x^{-1} \equiv 1 (mod p)$，则 $x × x ^{−1 }= kp + 1, k ∈ Z$。

于是$ \frac{x\times x^{-1}}{d} =\frac{kp + 1}{d} $。

于是$ \frac{x}{d} × x ^{−1} =\frac{ p× k}{d} + \frac{1}{d }$。

由于$d | x 且 d | p$，所以等号左边是整数， 等号右边$ p d × k $是整数，加上 $\frac{1}{d} $是分数。

整数不可能等于分数， 矛盾。

##### 推论

当且仅当模数 p 是质数时，[1, p − 1] 内所有整数都存在唯一一个互不相同模 p 下的逆元。0 没有逆元。







模板[P3811 【模板】乘法逆元](https://www.luogu.com.cn/problem/P3811)

```cpp
ll exgcd(ll a, ll b, ll &x, ll &y) {
    if (a % b == 0) {
        x = 0, y = 1;
        return b;
    } else {
        ll d = exgcd(b, a % b, y, x);
        y -= a / b * x;
        return d;
    }
}

ll inv(ll a, ll m) { //a * x == 1 (mod m) 乘法逆元
    ll x, y;
    exgcd(a, m, x, y);
    x = (x % m + m) % m;
    return x;
}
```
